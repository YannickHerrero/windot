#!/usr/bin/env bash
# notes - A CLI tool for managing notes with git sync
#
# Usage: notes [command] [args...]
# Run 'notes help' for more information.

set -euo pipefail

# Get the directory where this script is located
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
SUBCOMMANDS_DIR="$SCRIPT_DIR/notes.d"

# Source common functions
source "$SUBCOMMANDS_DIR/common.sh"

# Source all subcommand files
for file in "$SUBCOMMANDS_DIR"/*.sh; do
    source "$file"
done

# Main dispatcher
main() {
    local command="${1:-}"
    
    case "$command" in
        "")
            cmd_open
            ;;
        add)
            shift
            cmd_add "$@"
            ;;
        list|ls)
            cmd_list
            ;;
        search|s)
            shift
            cmd_search "$@"
            ;;
        help|--help|-h)
            cmd_help
            ;;
        *)
            error "Unknown command: $command. Run 'notes help' for usage."
            ;;
    esac
}

main "$@"
